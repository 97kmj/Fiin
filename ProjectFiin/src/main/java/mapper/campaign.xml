<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<!--// Mapper: dto와 sql문 이어주는 역할 -->
<!--	# // campaign ( ) 부분은 db와 매핑 되는 값-->
<!--	# // value (#{}...) 부분은 dto와 매핑되는 값-->

<mapper namespace="mapper.campaign">

<!--	//상민 - campaignRegister(캠페인 등록)-->
	<insert id="registerCampaign" parameterType="campaign" >
	<![CDATA[
   		INSERT INTO campaign (company_name, company_url, campaign_title, product_name, requirement,
                     CHANNEL, image, category_id)
    	VALUES (#{companyName}, #{companyUrl}, #{campaignTitle}, #{productName}, #{requirement},
           			#{channel}, #{image}, #{categoryId})
    	]]>
	</insert>

	<select id="selectCampaign" parameterType="Integer" resultType="campaign">											
		<![CDATA[
		 	select * from campaign where campaign_num = ?
		]]>
	</select>
	
	<select id="selectAllCampaign" parameterType="Map" resultType="campaign">
		select * from campaign 
		where 1=1
			<if test="categoryId != 0">
				and category_id=#{categoryId}
			</if>
			<if test="channel != null">
				and channel like ‘%${channel}%’
			</if>
		order by update_start_date desc limit #{row}, 8
	</select>
	
	<select id="selectCampaignCount" resultType="integer">
		<![CDATA[
			select Count(*) from Campaign
		]]>
	</select>
	
	
	
	
	
	<select id="selectCampaignAndReceive" parameterType="integer" resultType="campaign">											
		<![CDATA[
		 	select * from campaign c join receive_campaign r 
		 	using(campaign_num)
		 	where influencer_num = ? order by c.update_start_date desc limit #{row}, 8
		]]>
	</select>
	<select id="selectCampaignAndrequest" parameterType="integer" resultType="campaign">											
		<![CDATA[
		 	select * from campaign c left join request.campaign r 
		 	using(campaign_num)
		 	where influencer_num = ? order by c.update_start_date desc limit #{row}, 8
		]]>
	</select>
		<select id="selectInfluencerAndrequest" parameterType="integer" resultType="campaign">											
		<![CDATA[
			SELECT *FROM influencer inf LEFT JOIN influencer_detail inf_det
			ON inf.influencer_id = inf_det.influencer_id
			WHERE influencer_id = (SELECT * FROM request WHERE campain_no =?)
		]]>
	</select>
</mapper>	

